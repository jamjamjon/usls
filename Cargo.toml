[package]
name = "usls"
edition = "2021"
version = "0.1.7"
rust-version = "1.85"
description = "A Rust library integrated with ONNXRuntime, providing a collection of ML models."
repository = "https://github.com/jamjamjon/usls"
authors = ["Jamjamjon <xxyydzml@outlook.com>"]
license = "MIT"
readme = "README.md"
keywords = [
    "onnx",
    "onnxruntime",
    "yolo",
    "ai",
    "inference",
    "computer-vision",
    "vision-language",
    "deep-learning",
    "machine-learning",
    "neural-network",
    "image-processing",
]
categories = [
    "science::machine-learning",
]
exclude = ["assets/*", "examples/*", "runs/*", "benches/*", "tests/*"]


[dependencies]
anyhow = { version = "1" }
slsl = { version = "0.0.7", features = ["rayon"], optional = true }
aksr = { version = "0.0.6" }
ab_glyph = { version = "0.2.32" }
image = { version = "0.25" }
imageproc = { version = "0.25" }
ndarray = { version = "0.16.1", features = ["rayon"] }
half = { version = "2.7.1", features = ["bytemuck", "num-traits"] }
indicatif = { version = "0.18" }
log = { version = "0.4.26" }
prost = { version = "0.14.1" }
paste = { version = "1.0.15" }
rand = { version = "0.9" }
http = { version = "1.3" }
ureq = { version = "3" }
serde = { version = "1.0", features = ["derive"] }
serde_json = { version = "1.0" }
rayon = { version = "1.10.0" }
glob = { version = "0.3.3" }
dirs = { version = "6.0.0" }
chrono = { version = "0.4.40" }
regex = { version = "1.12.2" }
tempfile = { version = "3.23.0" }
fast_image_resize = { version = "=5.1.4", features = ["image", "rayon"] }
minifb = { version = "0.28.0", optional = true }
video-rs = { version = "0.10.3", features = ["ndarray"], optional = true }
ndarray-npy = { version = "0.9.1", optional = true  }
ort = { version = "=2.0.0-rc.10", default-features = false, optional = true, features = [
  "copy-dylibs",
  "half",
  "std",
] }
hf-hub = { version = "0.4.3", default-features = false, features = ["ureq", "native-tls"], optional = true }
tokenizers = { version = "0.22.1", optional = true }


[dev-dependencies]
argh = { version = "0.1.13" }
tracing-subscriber = { version = "0.3.18", features = ["env-filter", "chrono"] }


[profile.dev]
opt-level = 1
incremental = true

[profile.release]
opt-level = 3
lto = "fat"
codegen-units = 1
panic = "abort"
debug = false


[features]
default = ["ort-download-binaries", "yolo"]

# Utility features
video = ["dep:video-rs"]
viewer = ["dep:minifb"]

# ONNX Runtime features
ort-download-binaries = ["ort", "ort/download-binaries"]
ort-load-dynamic = ["ort", "ort/load-dynamic"]


# ONNX Runtime execution providers
acl = ["ort/acl"]
armnn = ["ort/armnn"]
azure = ["ort/azure"]
cann = ["ort/cann"]
coreml = ["ort/coreml"]
cuda = ["ort/cuda"]
directml = ["ort/directml"]
migraphx = ["ort/migraphx"]
nnapi = ["ort/nnapi"]
onednn = ["ort/onednn"]
openvino = ["ort/openvino"]
qnn = ["ort/qnn"]
rknpu = ["ort/rknpu"]
rocm = ["ort/rocm"]
tensorrt = ["ort/tensorrt"]
tvm = ["ort/tvm"]
vitis = ["ort/vitis"]
xnnpack = ["ort/xnnpack"]

# Tokenizers feature (required for vision-language models)
tokenizers = ["dep:tokenizers"]

# Hugging Face hub support (for downloading models from Hugging Face)
hf-hub = ["dep:hf-hub"]

# SLSL tensor library (used by yolo and clip)
slsl = ["dep:slsl"]

# Model features
pipeline = []
apisr = []
ben2 = []
blip = ["tokenizers"]
clip = ["tokenizers", "slsl"]
db = []
depth-anything = []
depth-pro = []
dino = []
fastvlm = ["tokenizers"]
florence2 = ["tokenizers"]
grounding-dino = ["tokenizers"]
image-classifier = ["pipeline"]
mediapipe-segmenter = []
modnet = []
moondream2 = ["tokenizers", "ndarray-npy"]
mot = []
owl = ["tokenizers"]
picodet = []
rmbg = []
rfdetr = []
rtdetr = []
rtmo = []
rtmpose = []
sam = []
slanet = ["pipeline"]
smolvlm = ["tokenizers"]
sapiens = []
svtr = []
swin2sr = []
trocr = ["tokenizers"]
yolo = ["slsl"]
yoloe = ["yolo", "tokenizers"]
yolop = []

# Enable all models
all-models = [
    "yolo",
    "yoloe",
    "sam",
    "clip",
    "apisr",
    "image-classifier",
    "ben2",
    "blip",
    "db",
    "depth-anything",
    "depth-pro",
    "dino",
    "fastvlm",
    "florence2",
    "grounding-dino",
    "mediapipe-segmenter",
    "modnet",
    "moondream2",
    "owl",
    "picodet",
    "rfdetr",
    "rmbg",
    "rtdetr",
    "rtmo",
    "rtmpose",
    "sapiens",
    "slanet",
    "smolvlm",
    "svtr",
    "swin2sr",
    "trocr",
    "yolop",
    "mot",
]


[[example]]
name = "read_video"
required-features = ["video"]

[[example]]
name = "imshow"
required-features = ["viewer"]

[[example]]
name = "apisr"
required-features = ["apisr"]

[[example]]
name = "ben2"
required-features = ["ben2"]

[[example]]
name = "blip"
required-features = ["blip"]

[[example]]
name = "classifier"
required-features = ["image-classifier"]

[[example]]
name = "clip"
required-features = ["clip"]

[[example]]
name = "d-fine"
required-features = ["rtdetr"]

[[example]]
name = "db"
required-features = ["db"]

[[example]]
name = "deim"
required-features = ["rtdetr"]

[[example]]
name = "deimv2"
required-features = ["rtdetr"]

[[example]]
name = "depth-anything"
required-features = ["depth-anything"]

[[example]]
name = "depth-pro"
required-features = ["depth-pro"]

[[example]]
name = "dinov2"
required-features = ["dino"]

[[example]]
name = "dinov3"
required-features = ["dino"]

[[example]]
name = "doclayout-yolo"
required-features = ["yolo"]

[[example]]
name = "dwpose"
required-features = ["rtmpose"]

[[example]]
name = "fast"
required-features = ["db"]

[[example]]
name = "fastsam"
required-features = ["yolo"]

[[example]]
name = "fastvlm"
required-features = ["fastvlm"]

[[example]]
name = "florence2"
required-features = ["florence2"]

[[example]]
name = "grounding-dino"
required-features = ["grounding-dino"]

[[example]]
name = "linknet"
required-features = ["db"]

[[example]]
name = "mediapipe-selfie-segmentation"
required-features = ["mediapipe-segmenter"]

[[example]]
name = "modnet"
required-features = ["modnet"]

[[example]]
name = "moondream2"
required-features = ["moondream2"]

[[example]]
name = "owlv2"
required-features = ["owl"]

[[example]]
name = "picodet-layout"
required-features = ["picodet"]

[[example]]
name = "rfdetr"
required-features = ["rfdetr"]

[[example]]
name = "rmbg"
required-features = ["rmbg"]

[[example]]
name = "rtdetr"
required-features = ["rtdetr"]

[[example]]
name = "ultralytics-rtdetr"
required-features = ["rtdetr"]

[[example]]
name = "rtmo"
required-features = ["rtmo"]

[[example]]
name = "rtmpose"
required-features = ["rtmpose", "yolo"]

[[example]]
name = "rtmw"
required-features = ["rtmpose"]

[[example]]
name = "sam"
required-features = ["sam"]

[[example]]
name = "sam2"
required-features = ["sam"]

[[example]]
name = "sapiens"
required-features = ["sapiens"]

[[example]]
name = "slanet"
required-features = ["slanet"]

[[example]]
name = "smolvlm"
required-features = ["smolvlm"]

[[example]]
name = "svtr"
required-features = ["svtr"]

[[example]]
name = "swin2sr"
required-features = ["swin2sr"]

[[example]]
name = "trocr"
required-features = ["trocr"]

[[example]]
name = "yolo"
required-features = ["yolo"]

[[example]]
name = "yolo-sam2"
required-features = ["yolo", "sam"]

[[example]]
name = "yolo-track"
required-features = ["yolo", "mot", "viewer"]

[[example]]
name = "yoloe-prompt"
required-features = ["yoloe"]

[[example]]
name = "yoloe-prompt-free"
required-features = ["yoloe"]

[[example]]
name = "yolop"
required-features = ["yolop"]
